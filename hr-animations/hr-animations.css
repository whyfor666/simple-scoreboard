:root{
  --bg: #0b0b0c;
  --fg: #e9e9ea;
  --muted:#9aa0a6;
  --surface:#17181a;
  --card:#1e2024;
  --primary:#4c8bf5;
  --danger:#d84b4b;
  --radius:16px;
  --appbar-h: 56px; 
}

*{box-sizing:border-box}
html,body{height:100%}
body{
  margin:0; 
  display: grid;
  grid-template-rows: auto 1fr; 
  font-family:system-ui,Segoe UI,Roboto,Helvetica,Arial,sans-serif;
  background:var(--bg); color:var(--fg);
  /* size: 1vh; */
}
.appbar{
  /* 
  display:flex; align-items:center; justify-content:space-between;
  padding:12px 16px; background:var(--surface); border-bottom:1px solid #2a2c31;
  position:sticky; top:0; z-index:10; 
  */
  min-height: var(--appbar-h); 
  }

/* Ensure overlays are above images */
.live-preview img  { z-index: 1; }
.live-text         { z-index: 2; }
.thumb .thumb-img  { z-index: 1; }
.thumb .thumb-text { z-index: 2; }

h1{font-size:4vh; margin:2vh}
nav{display:flex; gap:8px}

.hint { color:#eef1f4; }
.note { color:#cbd1d6; }

/* Full-width, full-height content area */
.container{
  max-width: none;                 
  padding: clamp(8px, 2vw, 16px);  /* responsive padding */
  overflow: auto;
  min-height: 0;
}

  /* Responsive full-width grid of thumbnail images */
.grid{
  display: grid;
  grid-template-columns: repeat(auto-fill, minmax(480px, 1fr)); /* grow/shrink */
  gap: clamp(8px, 1.5vw, 16px);
  align-content: start;            /* pack rows to the top */
}

.card{
  background:var(--card); border:1px solid #2a2c31; border-radius:var(--radius);
  display:flex; flex-direction:column; overflow:hidden;
}
/* This adjusts the thumbnail to 16:9 within the thumbnail page */
.thumb {
  position: relative;
  aspect-ratio: 16 / 9;       /* keep 16:9 without hardcoding height */
  width: 100%;                /* fill the grid cell */
/*  min-width: 120px;           /* don’t shrink below this */
/*  min-height: 68px;           /* matches 16:9 ratio */
  border-radius: 12px;
  /* background: #111; */
  overflow: hidden;
  display: flex;
  align-items: center;
  justify-content: center;
  cursor: zoom-in;     /* show magnifying glass + */
  display:flex; align-items:center; justify-content:center;

  /* Helps mobile avoid extra gesture delays */
  .thumb { touch-action: manipulation; }
}

/* This keeps the thumbnail proportions within the thumbnail page */
.thumb .thumb-mini {
  position: absolute;
  bottom: 4px;
  right: 4px;
  width: 36px;      /* smaller than editor mini */
  height: auto;
  border: 1px solid #666;
  background: #fff;
} 

/* Number badge on top-left of the thumbnail */
.thumb::before {
  content: attr(data-slotnum);
  position: absolute;
  top: 6px;
  left: 6px;
  font-size: 2rem;
  line-height: 1;
  background: rgba(0,0,0,.55);
  color: #fff;
  padding: 4px 6px;
  border-radius: 6px;
  border: 1px solid rgba(255,255,255,.25);
  z-index: 3; /* above image/text */
}

/* Mini preview stays bottom-right */
.thumb .thumb-mini {
  position: absolute;
  right: 6px;
  bottom: 6px;
  width: 4rem;
  height: auto;
  border: 1px solid rgba(255,255,255,.5);
  border-radius: 4px;
  box-shadow: 0 2px 6px rgba(0,0,0,.5);
  background: #222;
  z-index: 3;
}

/* editor mini preview overrides. */
.mini-info .thumb-mini{
  position: static;
  display: inline-block;
  width: 48px;
  height: 32px;
}

.thumb-mini {
  position: absolute;
  bottom: 4px;              /* adjust as you like for position */
  right: 4px;               /* adjust as you like for position */
  width: 48px;              /* small thumbnail size */
  height: auto;
  border: 1px solid #999;
  background: #fff;
}

.thumb { position: relative; width:100%; aspect-ratio:16/9; border-radius:12px; overflow:hidden; }
.thumb .thumb-img { position:absolute; inset:0; width:100%; height:100%; object-fit:fill; display:none; }
.thumb .thumb-text { position:absolute; inset:0; display:flex; align-items:center; justify-content:center; }
.thumb .thumb-text.over-image {
  color:#fff !important; background:rgba(0,0,0,.3);
  padding: 0.25em .5em; border-radius:10px; text-shadow:0 2px 4px rgba(0,0,0,.6);
}

/* This is the mini image inside the thumbnail images */
.mini-info {
  position: relative;       /* make container positioning context */
}

.mini-info .mini-size {
  margin-left: 8px;
  font-size: .9rem;
  color: var(--muted, #9aa0a6);
}

.card-top{padding:10px 10px 0}
.card-bottom{padding:10px}
.meta{font-size: 0.85rem; color:var(--muted); margin-bottom:8px}
.row{display:flex; gap:8px}
.btn{
  appearance:none; border:1px solid #2a2c31; background:#23252a; color:var(--fg);
  padding:8px 12px; border-radius:10px; cursor:pointer
}
.btn.small{padding:6px 10px; font-size:0.9rem}
.btn.primary{background:var(--primary); border-color:transparent}
.btn.danger{background:#990000; border-color:#4a2323; color:#f7d7d7}
.btn:active{transform:translateY(1px)}

.badge{
  font-size:0.9rem; padding:4px 8px; border-radius:999px;
  background:#3a1d1d; color:#f7d7d7; border:1px solid #4a2323;
}

/* Editor */
dialog::backdrop{background:rgba(0,0,0,.6)}
dialog{border:none; padding:0; background:transparent}
.editor{
  width:min(900px,95vw); background:var(--surface); border:10px solid #7e7e7e; border-radius:20px; overflow:hidden
}
.editor-head{
  padding:14px 16px; border-bottom:1px solid #2a2c31; display:flex; align-items:center; justify-content:space-between
}
.editor-body{
  display:grid; gap:16px; padding:16px;
  grid-template-columns:1.1fr .9fr;
}
.preview-wrap{display:flex; flex-direction:column; gap:8px}

/* Ensure all editor uses the light foreground color */
.editor,
.editor h2,
.editor label,
.editor legend,
.editor .field > span,
.editor .note {
  color: var(--fg) !important;
}

/* Slightly lift the editor header for contrast */
.editor-head { background: #1b1d21; }

/* Improve placeholder visibility too (optional) */
.field input::placeholder { color: #b6bbc2; }

/* EDITOR PREVIEW: also 16:9 stage */
.live-preview{
  position: relative;
  width: 100%;
  aspect-ratio: 16 / 9;
  border-radius: 16px;
  overflow: hidden;
  background: #222;
  border: 1px solid #2a2c31;
}
.live-preview img{
  position:absolute; inset:0; width:100%; height:100%; object-fit:fill; display:none;
}

.live-text{
  position:absolute; inset:0; display:flex; align-items:center; justify-content:center;
  font-size:clamp(20px,4vw,48px); font-weight:800; text-align:center; padding: 0.25em .5em;
  border-radius:12px; text-shadow:0 2px 4px rgba(0,0,0,.5);
}
/* Readable overlay when text is on top of an image */
.live-text.over-image{
  color:#fff !important;
  background:rgba(0,0,0,.35);  
  padding: 0.35em .6em;
  border-radius:12px;
  text-shadow:0 2px 4px rgba(0,0,0,.6);
}
.live-text.anim-flash { animation: flashKey 1.2s linear infinite }
.live-text.anim-zoom  { animation: zoomKey  1.6s ease-in-out infinite }
.live-text.anim-spin  { animation: spinKey  2.2s linear infinite; display:inline-block }

.note{color:var(--muted)}
.fields{display:grid; gap:12px; align-content:start}
.field{display:flex; flex-direction:column; gap:6px}
.field input[type="text"]{padding:10px 12px; border-radius:10px; border:1px solid #2a2c31; background:#1c1e22; color:var(--fg)}
.field input[type="color"]{height:40px; width:80px; padding:0; border-radius:8px; border:1px solid #2a2c31; background:#1c1e22}
.actions-row{display:flex; gap:8px; margin-top:8px}

/* Message animation styles */
@keyframes flashKey {
  0%,49% { opacity: 1 }
  50%,99% { opacity: 0.15 }
}
@keyframes zoomKey {
  0%   { transform: scale(0.9) }
  50%  { transform: scale(1.05) }
  100% { transform: scale(0.9) }
}
@keyframes spinKey {
  0% { transform: rotate(0deg)   scale(1.0) }
  50%{ transform: rotate(180deg) scale(1.05) }
  100%{transform: rotate(360deg) scale(1.0) }
}

.fieldset { border:0; padding:0; margin:0 }
fieldset label { display:inline-flex; gap:6px; align-items:center; margin-right:12px }
/* Fullscreen preview */

/* Minimum display spec notice */
.spec-overlay{
  position:fixed; inset:0; background:rgba(0,0,0,.7);
  display:flex; align-items:center; justify-content:center; z-index:9999;
}
.spec-card{
  background:#1e2024; color:#fff; padding:20px 24px; border-radius:14px;
  border:1px solid #2a2c31; max-width:520px; text-align:center;
}

/* Appbar: title left, instructions center, buttons right */
.appbar{
  display:flex; align-items:center; justify-content:space-between;
  gap: 12px;
  padding:12px 16px;
  background:var(--surface);
  border-bottom:1px solid #2a2c31;
  position:sticky; top:0; z-index:10;
}
.appbar h1{ margin:0; font-size:2rem }
.app-instructions{
  margin:0; flex:1; text-align:center;
  color:#cbd1d6; font-size:1rem;
}

/* Fullscreen preview */
.fs{
  position:fixed; inset:0; display:none;
  align-items:center; justify-content:center;
  background:rgba(0,0,0,.85);
  z-index: 10000;
  cursor: zoom-out; /* hint: click to close */
}
.fs.show{ display:flex; }

.fs-stage span.over-image{
  background:rgba(0,0,0,0.35);
  padding: 0.35em .6em; border-radius:12px;
}
/* ===== Force fullscreen edge-to-edge, override older rules ===== */
.fs-stage{
  position: fixed !important;
  top: 0; left: 0; right: 0; bottom: 0;
  width: 100vw !important;
  height: 100vh !important;
  border: none !important;
  border-radius: 0 !important;
  overflow: hidden;
  background: #000; /* replaced by slot.bg in JS */
  z-index: 10001;   /* above header */
}
.fs-stage img{
  position: absolute; inset: 0;
  width: 100% !important;
  height: 100% !important;
  object-fit: fill !important;  /* fill, crop edges */
  display: none;                 /* JS toggles to block */
  z-index: 1;
}
.fs-stage span{
  position: absolute; inset: 0;
  display: flex; align-items: center; justify-content: center;
  font-size: clamp(24px, 8vw, 84px);
  font-weight: 800; text-align: center;
  color: #fff; text-shadow: 0 2px 6px rgba(0, 0, 0, 0.7);
  z-index: 2;
}
/* Force stretch (no cropping) everywhere */
.thumb > img.thumb-img { 
  width:100% !important; height:100% !important; object-fit: fill !important; 
}

.live-preview img {
  width:100% !important; height:100% !important; object-fit: fill !important;
}

.fs-stage img {
  width:100% !important; height:100% !important; object-fit: fill !important;
}

/* Allow any element to use the message animations */
.anim-flash { animation: flashKey 1.2s linear infinite; }
.anim-zoom  { animation: zoomKey  1.6s ease-in-out infinite; }
.anim-spin  { animation: spinKey  2.2s linear infinite; }

/* Ensure message text looks proportional across all views */
.thumb-text,
#liveText,
#fsText {
  font-size: 4rem;      /* relative to container height */
  line-height: 1.1;
  word-break: break-word;
  text-align: center;
  justify-content: center;
  align-items: center;
}
/* Unify message text style across all contexts */
.thumb-text,
#liveText,
#fsText {
  font-size: 4rem;      /* same as edit preview */
  font-family: inherit; /* or pick your scoreboard font */
  line-height: 1.1;
  text-align: center;
  display: flex;
  justify-content: center;
  align-items: center;
  word-break: break-word;
}

.thumb { position: relative; }
.thumb-size-badge {
  position: absolute;
  left: 6px;
  bottom: 6px;
  padding: 2px 6px; 
  font-size: 12px; 
  line-height: 1;
  background: rgba(0,0,0,0.65); 
  color: #fff; 
  border-radius: 6px;
  pointer-events: none; 
  user-select: none;
}
.thumbs-grid { display:grid; grid-template-columns:repeat(auto-fill,minmax(120px,1fr)); gap:10px; }

/* Do NOT show the slot-number badge on the editor's upload thumbnails */
/* #thumbnails .thumb::before { content: none !important; } */

/* Make sure the KB badge sits above the image */
.thumb-size-badge { z-index: 3; }

.totals { margin-top: 6px; font-size: 0.95rem; }
.totals .row { display: flex; justify-content: space-between; gap: 8px; }
.totals .key { color: var(--muted, #9aa0a6); }
.totals .val { font-weight: 600; }

/* hidden on screen */
.print-totals { display: none; gap: 0.4in; font-size: 12pt; }

/* --- mini preview box (shared by thumbnails + editor) --- */
.mini-box {
  position: absolute;
  right: 6px;
  bottom: 6px;
  width: 64px;           /* adjust if you want larger/smaller minis */
  height: 36px;          /* keep 16:9 look */
  border: 1px solid #0002;
  overflow: hidden;
  border-radius: 4px;
  z-index: 2;            /* above image, below slot badge */
  display: grid;
  place-items: center;
}
.mini-box .thumb-mini {
  display: block;
  width: 100%;
  height: 100%;
  object-fit: fill;
  background: transparent; /* mini itself has no bg; checkerboard is on the box */
}

/* checkerboard pattern (applied to .mini-box) */
@media screen {
  .checkerboard {
    background-color: #fff;
    background-image:
      linear-gradient(45deg, #dcdcdc 25%, transparent 25%),
      linear-gradient(-45deg, #dcdcdc 25%, transparent 25%),
      linear-gradient(45deg, transparent 75%, #dcdcdc 75%),
      linear-gradient(-45deg, transparent 75%, #dcdcdc 75%);
    background-size: 16px 16px;
    background-position: 0 0, 0 8px, 8px -8px, -8px 0;
  }
}

/* print: hide mini altogether (you asked to hide it on paper) */
@media print {
  .mini-box { display: none !important; }
}

/* === Print-only layout & visibility === */
@page { size: letter portrait; margin: 0.5in; }


@media print {
  body {
    -webkit-print-color-adjust: exact !important;
    print-color-adjust: exact !important;
  }
}

@media print {
   
  /* show in print */
  .print-totals {
    display: flex !important;
    margin: 0 0 0.15in 0.25in;   /* aligns under the title */
  }
  .print-totals strong { font-weight: 700; }
  
  :root { --bg:transparent; --fg:black; }
  
  /* Keep just the title, hide UI chrome */
  .app-instructions, .button-row, nav, .spec-overlay, .fs, dialog { display: none !important; }
  .appbar { background:  rgb(0, 0, 0, 0.05) !important; box-shadow: none !important; border: 0 !important; }
  .appbar h1 { margin: 0 0 0 0.25in !important; font-size: 32pt !important; }

  /* 2 columns for 10 cards (≈5 rows) */
  .grid {
    display: grid !important;
    grid-template-columns: repeat(2, minmax(0, 1fr)) !important;
    gap: 0.1in !important;
    align-content: start !important;
  }

  /* Remove outer white frame around thumbnails*/
  .card {
    padding: 0 !important;
    border: 0 !important;
    box-shadow: none !important;
    background: transparent;
    break-inside: avoid !important;
  }

  /* Thumbnail: no black fill; simple 2px black border */
  .thumb {
    position: relative !important;
    background: transparent !important; 
    border: 2px solid #000 !important; 
    outline: none !important;
    height: 1.6in !important;       /* ~5 rows on Letter */
  }

  /* Fill the thumb with the main image */
  .thumb .thumb-img {
    /* display: block !important; */
    position: absolute !important; inset: 0 !important;
    width: 100% !important; height: 100% !important; object-fit: fill !important;
    background: #fff !important; border: 0 !important;
  }

  /* Hide mini thumbnail; keep Slot# (::before) and KB */
  .thumb .thumb-mini { display: none !important; }

  /* Slot# prints above image and visible on white */
  .thumb::before {
    z-index: 6 !important;
    background: rgba(0,0,0,0.5);
    color: #fff !important;
    border: 1px solid rgba(255,255,255,0.25);
  }

  /* KB badge: keep bottom-left; black text on white */
  .thumb-size-badge {
    /* top: 6px !important; right: 6px !important; */
    /* left: auto !important; bottom: auto !important; */
    background: #fff !important; color: #0040ff !important;
    border: 2px solid #0af9e1 !important;
    z-index: 5 !important;
    font-size: 10pt !important;
    padding: 2px 4px !important;
  }

}

/* Checkerboard for transparency – minis only (screen) */
@media screen {
  /* classic 8px checker */
  .checkerboard {
    background-image:
      linear-gradient(45deg, #ccc 25%, transparent 25%),
      linear-gradient(-45deg, #ccc 25%, transparent 25%),
      linear-gradient(45deg, transparent 75%, #ccc 75%),
      linear-gradient(-45deg, transparent 75%, #ccc 75%);
    background-size: 16px 16px;
    background-position: 0 0, 0 8px, 8px -8px, -8px 0px;
  }

  /* apply checkerboard behind the mini image squares */
  .thumb .thumb-mini,
  #liveMini {
    background: none;           /* reset any existing bg */
  }
  .thumb .thumb-mini.checkerboard,
  #liveMini.checkerboard {
    /* the checker shows through transparent pixels of the <img> */
    background: none;
  }
}

/* Mini box: a fixed 16:9 window that clips its child image */
.mini-box{
  width: 64px;
  height: 36px;               /* 16:9 */
  border: 1px solid #0002;
  border-radius: 4px;
  overflow: hidden;           /* prevent “escape” */
  box-sizing: border-box;     /* include the border in the 64×36 */
  background: none;
}

/* The mini image fills the box */
.mini-box .thumb-mini{
  display: block;
  width: 100%;
  height: 100%;
  object-fit: fill;          /* fills; change to 'contain' if you prefer letterboxing */
  background: transparent;
}

/* Place the mini nicely in the EDITOR row */
.mini-info{
  display: flex;
  align-items: center;
  gap: 8px;
}
.mini-info .mini-box{
  position: static;           /* not absolute in editor */
}

/* Place the mini in the bottom-right INSIDE each THUMBNAIL card */
.thumb{ position: relative; }  /* ensure a positioning context exists */
.thumb .mini-box{
  position: absolute;
  right: 6px;
  bottom: 6px;
}

/* Checkerboard pattern only for minis (screen only) */
@media screen{
  .mini-box.checkerboard{
    background-color: #fff;
    background-image:
      linear-gradient(45deg, #dcdcdc 25%, transparent 25%),
      linear-gradient(-45deg, #dcdcdc 25%, transparent 25%),
      linear-gradient(45deg, transparent 75%, #dcdcdc 75%),
      linear-gradient(-45deg, transparent 75%, #dcdcdc 75%);
    background-size: 16px 16px;
    background-position: 0 0, 0 8px, 8px -8px, -8px 0;
  }
}

/* In print, hide the mini entirely (as before) */
@media print{
  .mini-box{ display: none !important; }
}

/* --- STOP CROPPING / TRUNCATION (screen only) --- */
@media screen {
  /* Main thumbnail image: show whole image */
  .thumb .thumb-img {
    display: block !important;
    width: 100% !important;
    height: 100% !important;
    object-fit: fill !important;   /* no crop */
    background: transparent !important;
  }

  /* Mini image: also show whole image, confined to the mini box */
  .mini-box .thumb-mini {
    display: block !important;
    width: 100% !important;
    height: 100% !important;
    object-fit: fill !important;   /* no crop */
    background: transparent !important;
  }
}

/* Minis: remove right/bottom gaps by pinning the image to the box */
.mini-box { position: relative; }                /* ensure a positioning context */
.mini-box .thumb-mini{
  position: absolute; inset: 0;                  /* fill the box exactly */
  width: 100%; height: 100%;
  display: block;
  object-fit: fill;                              /* you said you prefer fill */
  background: transparent;
}
/* Nudge the editor's mini image to bleed by 0.5px and kill the bottom hairline */
.mini-info .mini-box .thumb-mini {
  inset: -0.5px;          /* slightly larger than the box on all sides */
  border-radius: inherit; /* keeps the rounded clip clean */
}

/* --- Mini previews (used in thumbnails grid and editor) --- */

/* Base mini-box: shared styles */
.mini-box {
  border: 1px solid #0002;
  border-radius: 4px;
  overflow: hidden;           /* clip image + checkerboard */
  box-sizing: border-box;
  background: none;
  position: relative;
  display: inline-block;
}

/* Checkerboard pattern applied to mini-box */
@media screen {
  .mini-box.checkerboard {
    background-color: #fff;
    background-image:
      linear-gradient(45deg, #dcdcdc 25%, transparent 25%),
      linear-gradient(-45deg, #dcdcdc 25%, transparent 25%),
      linear-gradient(45deg, transparent 75%, #dcdcdc 75%),
      linear-gradient(-45deg, transparent 75%, #dcdcdc 75%);
    background-size: 16px 16px;
    background-position: 0 0, 0 8px, 8px -8px, -8px 0;
  }
}

/* Thumbnail grid: minis are fixed-size, bottom-right of card */
.thumb {
  position: relative; /* anchor for absolute positioning */
}
.thumb .mini-box {
  position: absolute;
  right: 6px;
  bottom: 6px;
  width: 64px;
  height: 36px;      /* fixed 16:9 */
}
.thumb .mini-box .thumb-mini {
  position: absolute;
  inset: 0;
  width: 100%;
  height: 100%;
  object-fit: fill;   /* stretch to fill the box */
  display: block;
  background: transparent;
}

/* Editor: mini sits inline in the info row, height adapts to aspect */
.mini-info {
  display: flex;
  align-items: center;
  gap: 8px;
}
.mini-info .mini-box {
  width: 164px;       /* pick a width you like */
  height: 136px;      /* auto so height follows the image */
  position: static;  /* no absolute positioning here */
}
.mini-info .mini-box .thumb-mini {
  position: static;
  width: 100%;
  height: auto;
  display: block;
  object-fit: fill;  /* don’t stretch; keep aspect */
  background: transparent;
}

/* Print: hide minis entirely */
@media print {
  .mini-box { display: none !important; }
}

/* Editor: mini sits inline in the info row, fixed 16:9 box */
.mini-info .mini-box {
  width: 64px;
  height: 36px;       /* fixed same as thumbnails */
  position: static;
  flex-shrink: 0;     /* don’t collapse */
}
.mini-info .mini-box .thumb-mini {
  position: absolute;
  inset: 0;
  width: 100%;
  height: 100%;
  object-fit: fill;   /* or 'contain' if you prefer letterboxing */
  display: block;
  background: transparent;
}

/* === Ensure user-selected backgrounds print === */
@media print {
  /* Tell the browser to actually print backgrounds */
  body {
    -webkit-print-color-adjust: exact !important;
    print-color-adjust: exact !important;
  }

  /* Do NOT override the per-card background set inline by JS */
  .thumb {
    /* remove any earlier print background overrides */
    background: revert !important;   /* use the inline slot.bg */
  }

  /* Make sure the image itself doesn't paint a background that hides slot.bg */
  .thumb .thumb-img {
    background: transparent !important;
  }
}
@media print {
  /* tell the browser to print backgrounds */
  body { -webkit-print-color-adjust: exact !important; print-color-adjust: exact !important; }

  /* force the per-card background (even if earlier rules set white) */
  .thumb { background: var(--slot-bg) !important; }

  /* the image itself must not paint a background that hides slot.bg */
  .thumb .thumb-img { background: transparent !important; }
}
